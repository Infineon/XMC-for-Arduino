# options:
#   USE_CORE:
#     name: Infineon:xmc@3.5.0
#     url: https://github.com/Infineon/XMC-for-Arduino/releases/latest/download/package_infineon_index.json
options:
  USE_CORE:
    name: local
    url: https://balabla
#   # INCLUDE:
  #   - filename

compile:
    compile-xmc-kit_xmc47_relax:
      description: Compiling test_digitalio_single.cpp for XMC platform
      command: make -f Makefile.arduino.mk test_digitalio_single compile
      fqbns: [infineon:xmc:kit_xmc47_relax]
      working_dir: tests/arduino-core-tests

code-quality:
    source-code-quality-clang-tidy:
      description: clang-tidy check sources
      tool: clang-tidy
      command: extras/makers-devops/src/python/code_checks/run_clang_tidy.sh ./cores/xmc/* ./libraries/*

    source-code-quality-cppcheck:
      description: cppcheck check sources
      tool: cppcheck
      command: extras/makers-devops/src/python/code_checks/run_cppcheck.sh ./cores/xmc/* 
               | -I extras/arduino-core-api/api/ -I cores/xmc/xmc_lib/XMCLib/inc/ -I variants/XMC1400/config/KIT_XMC14_2GO
               | -I variants/XMC1400 -I cores/xmc/avr -I cores/xmc/usblib -I cores/xmc/xmc_lib/inc 
               | -I /cores/xmc
               | -i cores/xmc/xmc_lib/ -i cores/xmc/api/ --suppress=*:cores/xmc/xmc_lib/*
               | --suppress=*:extras/arduino-core-api/api/* --suppress=*:cores/xmc/api/*
    
#     test-code-quality-clang-tidy:
#       description: clang-tidy check tests
#       tool: clang-tidy
#       command: extras/makers-devops/tools/code_checks/run_clang_tidy.sh ./tests/arduino-core-tests/src/*

#     test-code-quality-cppcheck:
#       description: cppcheck check tests
#       tool: cppcheck
#       command: extras/makers-devops/tools/code_checks/run_cppcheck.sh ./tests/arduino-core-tests/src/*  
#                | -I extras/arduino-core-api/api/ -I variants/CY8CKIT-062S2-AI/mtb-bsp -I extras/mtb-libs/core-lib/include 
#                | -I libraries/WiFi/src -I libraries/Wire/src -I libraries/SPI/src -I extras/mtb-libs/mtb-hal-cat1/include
#                | -I extras/mtb-libs/wifi-connection-manager/include --suppress=*:extras/mtb-libs/wifi-connection-manager/include*
#                | -I tests/arduino-core-tests/Unity/src --suppress=*:tests/arduino-core-tests/Unity/src/*
#                | -I variants/CY8CKIT-062S2-AI -I cores/psoc6 --suppress=*:variants/CY8CKIT-062S2-AI/* --suppress=*:extras/mtb-libs/mtb-hal-cat1/include/*
#                | --suppress=*:extras/arduino-core-api/api/* --suppress=*:cores/psoc6/api/* --suppress=*:variants/CY8CKIT-062S2-AI/mtb-bsp/* --suppress=*:extras/mtb-libs/core-lib/include/*

#     code-quality-clang-format:
#       description: clang-tidy check sources
#       tool: clang-format
#       command: extras/makers-devops/tools/code_checks/run_clang_format.sh ./cores/psoc6/* ./libraries/*

#     code-quality-black-format:
#       description: clang-tidy check sources
#       tool: black-format
#       command: extras/makers-devops/tools/code_checks/run_black.sh ./extras/makers-devops/tools/* 



unit-test:
    unit-test-timer-4700:
      - description: Compiling, flashing and monitoring timer unit test.
        command: make test_time_single UNITY_PATH=/opt/Unity 
        query: time_single_board == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True

    unit-test-pwm-4700:
      - description: Compiling, flashing and monitoring timer unit test.
        command: make test_analogio_pwm UNITY_PATH=/opt/Unity 
        query: analogio_pwm_single_board == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True
          
    unit-test-analog-io-adc-4700:
      - description: Compiling, flashing and monitoring ADC unit test.
        command: make test_analogio_adc
        query: analogio_adc_single_board == '1:1'
        working_dir: extras/arduino-core-tests

    unit-test-iic-4700:
      - description: Compiling, flashing and monitoring timer unit test.
        command: make test_wire_connected1_pingpong UNITY_PATH=/opt/Unity 
        query: iic_ping_pong_single_board == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True     

    unit-test-iic-pingpong-4700:     
      - description: Compiling, flashing and monitoring I2C pingpong slave unit test.
        command: make test_wire_connected2_slavepingpong UNITY_PATH=/opt/Unity 
        query: iic_ping_pong_multiple_boards_slave == '2:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True

      - description: Compiling, flashing and monitoring I2C pingpong master unit test.
        command: make test_wire_connected2_masterpingpong UNITY_PATH=/opt/Unity 
        query: iic_ping_pong_multiple_boards_master == '2:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True
    
    unit-test-uart-connected2-4700:
      - description: Compiling, flashing and monitoring uart rx unit test.
        command: make test_uart_rx UNITY_PATH=/opt/Unity ENABLE_SYNC=0
        query: uart_multiple_boards_rx == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: False

      - description: Compiling, flashing and monitoring uart tx unit test.
        command: make test_uart_tx UNITY_PATH=/opt/Unity ENABLE_SYNC=0
        query: uart_multiple_boards_tx == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: False

    unit-test-iic-pingpong-1400:
      - description: Compiling, flashing and monitoring I2C pingpong slave unit test.
        command: make test_wire_connected2_slavepingpong UNITY_PATH=/opt/Unity 
        query: iic_ping_pong_multiple_boards_slave == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True

      - description: Compiling, flashing and monitoring I2C pingpong master unit test.
        command: make test_wire_connected2_masterpingpong UNITY_PATH=/opt/Unity 
        query: iic_ping_pong_multiple_boards_master == '1:1'
        working_dir: extras/arduino-core-tests
        options:
          SEND_JOB_START_TOKEN: True
